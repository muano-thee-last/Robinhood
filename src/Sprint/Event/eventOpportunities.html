<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Opportunities</title>
    <link rel="stylesheet" href="eventOpportunities.css">
</head>
<body>
    <header>
        <h1>Event Opportunities</h1>
        <nav>
            <ul>
                <li><a href="EventDashboard.html" id="Dash">Dashboard</a></li>
                <li><a href="eventOpportunities.html" class="active" id="opportunities">Event Opportunities</a></li>
                <li><a  id="applications">Applications</a></li>
                <li><a >Profile</a></li>
                <li><a>Logout</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="opportunities">
            <h2>Available Event Funding Opportunities</h2>
            <table id="Events">
                <thead>
                    <tr>
                        <th>Event Funding Opportunity</th>
                        <th>Description</th>
                        <th>Eligibility Criteria</th>
                        <th>Application Deadline</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="BursaryData">
                   
                    <!-- Add more rows as needed -->
                </tbody>
            </table>
            
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Event Funding Portal</p>
    </footer>
</body>
</html>

    
    <script type="module" defer>
         import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
        
        const firebaseConfig = {
          apiKey: "AIzaSyD5aPXd4DjzXI-zU4_CbOur2q8BtJ1tr1Y",
          authDomain: "fir-sd-22d1a.firebaseapp.com",
          databaseURL: "https://fir-sd-22d1a-default-rtdb.firebaseio.com",
          projectId: "fir-sd-22d1a",
          storageBucket: "fir-sd-22d1a.appspot.com",
          messagingSenderId: "526172429927",
          appId: "1:526172429927:web:51ae427f7acfa1d925bec2"
        };
      
        
        const app = initializeApp(firebaseConfig);

        import {getDatabase,ref,child,get,set,update,remove,onValue} from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js"
        const db=getDatabase();

        const Dashboard=document.getElementById("Dash");
        const opportunities=document.getElementById("opportunities");
        const applications=document.getElementById("applications");
        //const profile=document.getElementById("profile");
        //const logout=document.getElementById("logout");
        //const section1=document.getElementById("BursaryInfo")
        

        
       

        //get all bursary
    function RetrieveAllEventFunders(){
        const dbref=ref(db);
        get(child(dbref,'EvenFunders')).then((snapshot)=>{
             let bursaries=[];
            snapshot.forEach(childSnapshot=>{
                var burs=childSnapshot.val();
                burs['id']=childSnapshot.key;
                bursaries.push(burs);
            
            })

            AddRow(bursaries);
            console.log(bursaries);
        }).catch((error)=>{
            alert("A network issue is causing some errors with the operation")  ;
            console.log(error);  
         })
    };

        //basic page nav
        function DashBoard(){
            window.location.href = 'eventDashBoard.html';
        }

        function Opportuninties(){
            window.location.href = 'eventOpportunities.html';
        }

        // function Profile(){
        //     window.location.href = 'Profile.html';
        // }

        // function LogOut(){
        //     window.location.href = 'BasicLogin.html';
        // }

        function ApplicationForm(){
            window.location.href = 'Application.html';
        }

        function AddRow(eventS){
            let THead=document.getElementById('BursaryData');
                let Deadline='';
                let Opportunity='';
                let Description='';
                let Criteria='';
                let id=''; 
             let Evs={};   
            eventS.forEach(bursary => {
                    id=bursary.id;
                   const fundingOpp=bursary["funder"];
                   //Contact=bursary.contact; 
                   Deadline=bursary.deadline;
                   Criteria=bursary.citeria;
                   Description=bursary.description;
                   Evs['id']=id;
                   Evs['funder']=fundingOpp;
                   Evs['description']=Description;
                   Evs['deadline']=Deadline;
                   Evs['citeria']=Criteria;
                   //Evs['description']=Desc;
                   let newTableRow=document.createElement('tr');
                   newTableRow.setAttribute('id','row');
                  // newTableRow.setAttribute('id',`${id}`);

                   let BursaryName=document.createElement('td');
                   let BursaryContact=document.createElement('td');
                   let BursaryDeadline=document.createElement('td');
                   let BursaryDeadline1=document.createElement('td');
                   let BursaryDeadline2=document.createElement('td');
                   //let BursaryInfo=document.createElement('h3');
                   let BursaryView=document.createElement('td');
                   let viewButton=document.createElement('a');
                   viewButton.innerText='Apply Now';
                   viewButton.href='eventApplication.html';

                   BursaryName.textContent=fundingOpp;
                   BursaryContact.textContent=Description;
                   BursaryDeadline.textContent=Criteria;
                   BursaryDeadline1.textContent=Deadline;
                   BursaryDeadline2.append(viewButton);
                  
                    

                   newTableRow.append(BursaryName);
                   newTableRow.append(BursaryContact);
                   newTableRow.append(BursaryDeadline);
                   newTableRow.append(BursaryDeadline1);
                   newTableRow.append(BursaryDeadline2);
                   THead.append(newTableRow);
                   

            })
           //rowEventListner(burs);
        }

           // Get all the rows in the table
        

        // Loop through each row and add a click event listener
        

        Dashboard.addEventListener('click',()=>{
            DashBoard();
        });

        applications.addEventListener('click',()=>{
            Application();
        })

        // profile.addEventListener('click',()=>{
        //     Profile();
        // })

        // logout.addEventListener('click',()=>{
        //     LogOut();
        // })

        //display bursary info when page loaded
        document.addEventListener("DOMContentLoaded", function() {
            // Your code to be executed after the DOM content is fully loaded
            RetrieveAllEventFunders();
        });


        
    </script>
    
</body>
</html>